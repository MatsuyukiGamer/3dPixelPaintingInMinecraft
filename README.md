# 3dPixelPaintingInMinecraft
在minecraft中生成3d的地图画

实话说这是一个很普通的matlab程序，代码水平简陋但确保无虫。
它可以根据游戏的地图文件（map_i.dat）生成出一个mcfunction文件（minecraft数据包的函数），运行这个mcfuntion函数就可以在minecraft中重建出地图所描绘的地形。

它最主要的作用是构建立体的像素画。方块之间的相对高度关系编织出三种阴影，我充分利用了地图的51种基色和3种阴影，让地图可以显示出尽量丰富的画质。
153种基色可以让地图（游戏中的物品，而非存档）显示的像素画具有最丰富的的色彩，这远比平板像素画要好。

关于立体像素画的更多细节可以看这个视频，以及视频简介：
https://www.bilibili.com/video/BV1Ci4y1E7oU
如果想要了解立体地图画的原理也可以仔细阅读一下简介，或者去看一看mcwiki的“地图物品格式”条目——这是我最重要的参考资料

简略的使用方法：
是先去生成map文件；然后再用ReadUnpacked.exe生成4个txt文件；然后在matlab导入这四个文件；然后生成一个mcfunction文件；然后在mc用/function指令运行。


先介绍一下几个我常用的术语：
地图：特指游戏中可以记录地形的物品，不是存档。
地图文件：存储地图内容的文件，它们在\saves\存档名称\data\下面，文件名都是map_i.dat。其中i是大于等于0的整数，也就是地图的id。
地图色Color：地图文件中存储的数据，每个地图色取值都在0-255，占用一个Byte。地图色是minecraft根据方块id和方块位置计算出来的。
基色Base：顾名思义，基色的基础颜色。基色的取值范围是0-51，minecraft的地图中一共可以显示52种基础颜色，它们分别对应一个基色。除去0代表的透明颜色（虚空），一共有1~51个基色。基色由方块id唯一确定。
阴影Depth：阴影的取值范围是0-3，它描述的是方块之间的相对高度。如果一个方块A在地图中，它北侧的方块B比A高，那么A的Depth值为0;如果A与B高度相同，则A的Depth值为1；如果A的高度比B高，那么A的Depth值为2。Depth值为3只能用第三方软件来获得，mc正常录制地图时不会生成这样的地图。
因为地图大小都是128×128像素，所以Color、Base、Depth都是128行、128列的矩阵。水平向左是x+方向，竖直向下是z+方向
地图中每一个方块都有两个用途：表达自己的基色，并调节自己南侧方块的阴影。
高度Height：高度矩阵比其他矩阵多一行，尺寸为129×128。高度矩阵的每一个元素都代表了这个位置的方块的绝对高度。某种意义上，阴影是绝对高度的“导数”。地图最北侧的方块仍然需要它们北侧的方块来调节自己的阴影，所以高度矩阵多一行。多出的一行可以用任何种类的不透明方块，它们只起到调节地图最北侧方块阴影的作用，不会被地图记录下来。
水列表WaterList：水的阴影与其他方块截然不同。水的阴影与相对高度无关，只取决于自己的深度。然而水仍然可以调节自己南侧方块的阴影（1格深、5格深和7格深三个级别，不能获得第四个阴影），所以将水单独列出来，特殊处理。WaterList的每一列都代表一个水柱，第一行为水的行位置（i），第二行是水的列位置（j），第三行是水柱的顶点坐标，第四行是水柱的最低点坐标。
NWPos：导出地图的时候需要确定地图的坐标，NWPos是一个1×3的行向量[x,y,z]，它是地图西北角方块的坐标。默认为[-64,5,-64]。
Path：一个字符串，它是导出的mcfuntion的地址。
CBL：自定义的方块列表。

v1.0：第一个可以凑活着用的版本。它包含以下部分：
ReadUnpacked：一个c艹的应用程序，它的用途是提取解压后的地图文件。地图文件都是gzip压缩的，我非常菜搞不懂gzip，所以要先使用winrar或者bandzip手动解压地图文件，得到的文件应该是去掉了.dat后缀的map_i文件。使用ReadUnpacked.exe处理这个文件，得到4个txt，它们就是进行下一步所需的参数。

还没写完
